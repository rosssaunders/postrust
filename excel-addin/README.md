# openassay Excel Add-in

Run PostgreSQL queries over your Excel data — entirely in-browser via WebAssembly.

## How it works

1. **Import** — Select a range or table in Excel; the add-in reads the cells and creates an in-memory SQL table
2. **Query** — Write SQL in the task pane; the query runs locally via the openassay WASM engine
3. **Export** — Send results back to a new Excel sheet

No server, no network calls — everything runs in your browser.

## Quick Start

```bash
# 1. Build the WASM package (from repo root)
wasm-pack build --target web --out-dir excel-addin/pkg --release

# 2. Start the dev server
cd excel-addin
node serve.js

# 3. Open Excel Online (excel.office.com)
#    Insert → Office Add-ins → Upload My Add-in → manifest.xml
```

## Features

- **Full PostgreSQL SQL** — JOINs, CTEs, window functions, aggregates, JSON functions
- **Type inference** — automatically detects numbers, text, booleans, dates from Excel data
- **Batch import** — import selected range, named tables, or all sheets at once
- **Results to sheet** — export query results to a new Excel sheet
- **Ctrl+Enter** — keyboard shortcut to run queries
- **Zero latency** — everything runs locally in WASM, no round-trips

## Example

After importing a sheet named "Sales":

```sql
-- Top 5 customers by total spend
SELECT customer, SUM(amount) as total
FROM sales
GROUP BY customer
ORDER BY total DESC
LIMIT 5;

-- Monthly revenue with running total
SELECT
  date_trunc('month', order_date) as month,
  SUM(amount) as revenue,
  SUM(SUM(amount)) OVER (ORDER BY date_trunc('month', order_date)) as cumulative
FROM sales
GROUP BY 1
ORDER BY 1;
```

## Development

The add-in is a single HTML file (`taskpane.html`) that loads the WASM module.
No build tools, no frameworks — just HTML, CSS, and vanilla JS.

### Files

- `manifest.xml` — Office Add-in manifest (tells Excel where to find the add-in)
- `taskpane.html` — The add-in UI + all logic
- `serve.js` — HTTPS dev server (Office Add-ins require HTTPS)
- `pkg/` — WASM build output (generated by `wasm-pack`)

### Rebuilding WASM

```bash
# From repo root
wasm-pack build --target web --out-dir excel-addin/pkg --release
```

## Requirements

- Excel Online or Excel Desktop (Windows/Mac) with Office Add-ins support
- Node.js (for dev server)
- Rust + wasm-pack (to rebuild WASM)
